<div v-if="currentTab === 'jm_latest'" class="view-content pb-24 space-y-8 animate-fade-in">
    <!-- Header -->
    <div class="flex items-start justify-between gap-4">
        <div class="min-w-0 space-y-1">
            <h2 class="headline-medium font-bold text-on-surface flex items-center gap-3">
                <span class="material-symbols-rounded text-primary filled-icon text-4xl">new_releases</span>
                最新更新
            </h2>
            <p class="text-body-large text-on-surface-variant/80">
                全站最新更新的图集
            </p>
        </div>
        <div class="flex items-center gap-2">
            <button @click="loadJmLatest(1)" :disabled="jmLatestLoading"
                class="md-icon-btn bg-surface-container-high hover:bg-primary hover:text-on-primary rounded-full"
                title="刷新">
                <span class="material-symbols-rounded" :class="jmLatestLoading ? 'animate-spin' : ''">refresh</span>
            </button>
            <button @click="currentTab = 'home'"
                class="md-icon-btn bg-surface-container-high hover:bg-primary hover:text-on-primary rounded-full"
                title="返回首页">
                <span class="material-symbols-rounded">arrow_back</span>
            </button>
        </div>
    </div>

    <!-- Category Filter -->
    <div class="md-card p-4 md:p-6 bg-surface-container-low border-0">
        <div class="flex gap-2 overflow-x-auto max-w-full pb-2 no-scrollbar mask-linear-fade">
            <button v-for="c in jmCategories" :key="String(c.CID || c.id || c.name || c.title || c)"
                @click="selectJmCategoryForLatest(c)"
                class="md-chip h-10 px-5 text-sm font-medium whitespace-nowrap transition-all duration-300"
                :class="jmLatestCategory === getJmCategoryId(c) ? 'bg-primary text-on-primary shadow-lg shadow-primary/30 border-primary' : 'hover:bg-surface-container-high'">
                {{ getJmCategoryTitle(c) }}
            </button>
        </div>
    </div>

    <!-- Loading State -->
    <loading-state :loading="jmLatestLoading && jmLatestItems.length === 0">
        <span class="mt-4 text-body-medium text-on-surface-variant">加载最新内容中...</span>
    </loading-state>

    <!-- Error State -->
    <error-state :error="jmLatestError" @retry="loadJmLatest(1)"></error-state>

    <!-- Empty State -->
    <div v-if="!jmLatestLoading && !jmLatestError && jmLatestItems.length === 0" class="flex flex-col items-center justify-center py-24 opacity-60">
        <span class="material-symbols-rounded text-8xl text-outline-variant mb-4">inbox</span>
        <p class="headline-small text-on-surface-variant">暂无内容</p>
        <p class="text-body-medium mt-2 text-on-surface-variant/70">尝试刷新或选择其他分类</p>
    </div>

    <!-- Content Grid -->
    <div v-if="jmLatestItems.length > 0" class="space-y-8">
        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4 md:gap-6">
            <book-card 
                v-for="book in jmLatestItems" 
                :key="book.album_id" 
                :book="book" 
                @click="viewDetails">
            </book-card>
        </div>

        <!-- Pagination -->
        <div class="flex flex-col items-center gap-4">
             <div v-if="jmLatestLoading && jmLatestItems.length" class="flex items-center justify-center py-6 opacity-60">
                <span class="material-symbols-rounded text-4xl animate-spin text-primary">progress_activity</span>
            </div>
            <div v-else-if="!jmLatestHasMore" class="text-center text-label-medium opacity-60 py-4 uppercase tracking-widest">到底了</div>

            <pagination-controls 
                v-if="!jmLatestLoading"
                :page="jmLatestPage" 
                :loading="jmLatestLoading" 
                :has-more="jmLatestHasMore"
                @prev="loadJmLatest(jmLatestPage - 1)" 
                @next="loadJmLatest(jmLatestPage + 1)">
            </pagination-controls>
        </div>
    </div>
</div>
